(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/reg/reg"],{"14da":function(n,t,e){},4028:function(n,t,e){"use strict";(function(n,e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n.init({provider:"aliyun",spaceId:"380c7682-e928-4ccd-b19b-99323fd9fdc6",clientSecret:"dH77i2f5k0Jxp8wCY+Hcwg=="}),i={data:function(){return{userId:"",password:"",ent:"",mn:"",st:"",server:"",form:{nickName:"",content:"",uuid:"",avatarUrl:"",unionid:""},list:[{user_name:"加载中",content:"加载中"}],wHeight:0}},onLoad:function(){var n=this;e.login({provider:"weixin",success:function(t){console.log(t),e.showToast({title:"微信小程序登陆需要修改，云函数getUnionid的appid和secret",icon:"none",duration:5e3}),o.callFunction({name:"getUnionid",data:{js_code:t.code}}).then((function(t){console.log(t.result.data.unionid),n.form.unionid=t.result.data.unionid,n.getData()}))}})},methods:{signUp:function(){var t=this.userId,o=this.password,i=this.ent,a=this.mn,s=this.st,c=this.server;t.length<6||o.length<6?e.showModal({content:"用户名密码长度均不能小于6",showCancel:!1}):(e.showLoading({title:"注册中..."}),n.callFunction({name:"signUp",data:{userId:t,password:o,ent:i,mn:a,st:s,server:c}}).then((function(n){if(console.log(n),e.hideLoading(),0!==n.result.status)return Promise.reject(new Error(n.result.msg));e.setStorageSync("token",n.result.token),e.showModal({content:"注册成功，token已存储",showCancel:!1})})).catch((function(n){console.log(n),e.hideLoading(),e.showModal({content:"注册失败，"+n.message,showCancel:!1})})))},signIn:function(){var t=this.userId,o=this.password;t.length<6||o.length<6?e.showModal({content:"用户名密码长度均不能小于6",showCancel:!1}):(e.showLoading({title:"登录中..."}),n.callFunction({name:"signIn",data:{userId:t,password:o}}).then((function(n){if(console.log(n),e.hideLoading(),0!==n.result.status)return Promise.reject(new Error(n.result.msg));e.setStorageSync("token",n.result.token),e.showModal({content:"登录成功，token已存储",showCancel:!1})})).catch((function(n){console.log(n),e.hideLoading(),e.showModal({content:"登录失败，"+n.message,showCancel:!1})})))},loginMp:function(){e.showLoading({title:"登录中..."}),this.getCode().then((function(t){return console.log("code",t),n.callFunction({name:"login",data:{code:t}})})).then((function(n){if(e.hideLoading(),console.log(n),0!==n.result.status)return Promise.reject(new Error(n.result.msg));e.setStorageSync("token",n.result.token),e.showModal({content:"登录成功，token已存储",showCancel:!1})})).catch((function(n){console.log(n),e.hideLoading(),e.showModal({content:"出现错误，请稍后再试."+n.message,showCancel:!1})}))},getCode:function(){return new Promise((function(n,t){e.login({provider:"weixin",success:function(e){e.code?n(e.code):t(new Error("微信登录失败"))},fail:function(n){t(new Error("微信登录失败"))}})}))},validateToken:function(){e.showLoading({title:"加载中..."}),n.callFunction({name:"validateToken",data:{token:e.getStorageSync("token")}}).then((function(n){console.log(n),e.hideLoading(),e.showModal({content:n.result.msg,showCancel:!1})})).catch((function(n){e.hideLoading(),e.showModal({content:"请求云函数发生错误，"+n.message,showCancel:!1})}))},miniApplogin:function(n){console.log(n.detail.userInfo),this.form.nickName=n.detail.userInfo.nickName,this.form.avatarUrl=n.detail.userInfo.avatarUrl,this.add()},remove:function(n){var t=this;o.callFunction({name:"remove",data:{_id:n}}).then((function(n){t.getData()}))},getData:function(){var n=this;o.callFunction({name:"get"}).then((function(t){n.list=t.result.data}))},appPlusAdd:function(){},add:function(){var n=this;return""==this.form.user_name?(e.showToast({title:"昵称不能为空"}),!1):""==this.form.content?(e.showToast({title:"内容不能为空"}),!1):""==this.form.unionid?(e.showToast({title:"异常请稍后在试"}),!1):void o.callFunction({name:"add",data:this.form}).then((function(t){n.form.content="",n.getData()}))}}};t.default=i}).call(this,e("861b")["default"],e("df3c")["default"])},4284:function(n,t,e){"use strict";var o=e("14da"),i=e.n(o);i.a},"545f":function(n,t,e){"use strict";e.r(t);var o=e("4028"),i=e.n(o);for(var a in o)["default"].indexOf(a)<0&&function(n){e.d(t,n,(function(){return o[n]}))}(a);t["default"]=i.a},"5d65":function(n,t,e){"use strict";(function(n,t){var o=e("47a9");e("8ed8"),e("c891"),e("861b");o(e("3240"));var i=o(e("c62f"));n.__webpack_require_UNI_MP_PLUGIN__=e,t(i.default)}).call(this,e("3223")["default"],e("df3c")["createPage"])},c62f:function(n,t,e){"use strict";e.r(t);var o=e("f87c"),i=e("545f");for(var a in i)["default"].indexOf(a)<0&&function(n){e.d(t,n,(function(){return i[n]}))}(a);e("4284");var s=e("828b"),c=Object(s["a"])(i["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],void 0);t["default"]=c.exports},f87c:function(n,t,e){"use strict";e.d(t,"b",(function(){return o})),e.d(t,"c",(function(){return i})),e.d(t,"a",(function(){}));var o=function(){var n=this.$createElement;this._self._c},i=[]}},[["5d65","common/runtime","common/vendor"]]]);