(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/gasdata/history"],{1788:function(e,t,n){"use strict";(function(e,t){var a=n("47a9");n("8ed8"),n("c891"),n("861b");a(n("3240"));var i=a(n("59d6"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(i.default)}).call(this,n("3223")["default"],n("df3c")["createPage"])},"59d6":function(e,t,n){"use strict";n.r(t);var a=n("d949"),i=n("df9b");for(var s in i)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(s);n("d9d9");var o=n("828b"),u=Object(o["a"])(i["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],void 0);t["default"]=u.exports},a328:function(e,t,n){},d949:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return a}));var a={qiunDataCharts:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/qiun-data-charts/components/qiun-data-charts/qiun-data-charts")]).then(n.bind(null,"0b1d"))},uniForms:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uni-forms/components/uni-forms/uni-forms")]).then(n.bind(null,"8a10"))},uniFormsItem:function(){return n.e("uni_modules/uni-forms/components/uni-forms-item/uni-forms-item").then(n.bind(null,"5cf0"))},uniDatetimePicker:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uni-datetime-picker/components/uni-datetime-picker/uni-datetime-picker")]).then(n.bind(null,"c2e0"))},uniDataSelect:function(){return n.e("uni_modules/uni-data-select/components/uni-data-select/uni-data-select").then(n.bind(null,"fe12"))},uniTable:function(){return n.e("uni_modules/uni-table/components/uni-table/uni-table").then(n.bind(null,"d457"))},uniTr:function(){return n.e("uni_modules/uni-table/components/uni-tr/uni-tr").then(n.bind(null,"91ee"))},uniTh:function(){return n.e("uni_modules/uni-table/components/uni-th/uni-th").then(n.bind(null,"d0da"))},uniTd:function(){return n.e("uni_modules/uni-table/components/uni-td/uni-td").then(n.bind(null,"0742"))}},i=function(){var e=this.$createElement;this._self._c},s=[]},d9d9:function(e,t,n){"use strict";var a=n("a328"),i=n.n(a);i.a},df9b:function(e,t,n){"use strict";n.r(t);var a=n("ebec"),i=n.n(a);for(var s in a)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(s);t["default"]=i.a},ebec:function(e,t,n){"use strict";(function(e){var a=n("47a9");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n("7eb4")),s=a(n("ee10")),o={onLoad:function(e){this.equipment_model=e.mn,this.access_token=e.accesstoken,this.equipment_type=e.equipmentType,this.setDateTime(),console.log("设备名称"+this.equipment_model)},data:function(){return{show_hint:"上滑加载更多",total:0,from:0,date_section:[],end_time:Date.now(),equipment_model:"",access_token:"",equipment_type:"",radios:[{checked:!0,name:"实时"},{checked:!1,name:"分钟"},{checked:!1,name:"小时"},{checked:!1,name:"日"}],date_value:1,page_value:10,date_filters:[{value:1,text:"实时数据"},{value:2,text:"分钟数据"},{value:3,text:"小时数据"},{value:4,text:"日数据"}],page_filters:[{value:10,text:"10"},{value:20,text:"20"},{value:30,text:"30"},{value:50,text:"50"},{value:100,text:"100"}],equipment_factorName_group:[],equipment_data_group:[],lazy_equipment_data_group:[],charts_XCoords:[],charts_data_group:[],testdata:[{one:"2020-10-20",two:"10",three:"15.66",four:"50",five:"7",six:"55",seven:"50",eight:"79",nine:"60"},{one:"2020-10-20",two:"10",three:"15.66",four:"50",five:"7",six:"55",seven:"50",eight:"79",nine:"60"},{one:"2020-10-20",two:"10",three:"15.66",four:"50",five:"7",six:"55",seven:"50",eight:"79",nine:"60"},{one:"2020-10-20",two:"10",three:"15.66",four:"50",five:"7",six:"55",seven:"50",eight:"79",nine:"60"},{one:"2020-10-20",two:"10",three:"15.66",four:"50",five:"7",six:"55",seven:"50",eight:"79",nine:"60"}],chartData:{},opts:{color:["#1890FF","#91CB74","#FAC858","#EE6666","#73C0DE","#3CA272","#FC8452","#9A60B4","#ea7ccc"],padding:[15,10,0,15],legend:{},background:"rgba(78, 78, 78, 0.0)",enableScroll:!0,scrollAlign:"left",xAxis:{disableGrid:!0,itemCount:5,scrollShow:!0},yAxis:{gridType:"dash",dashLength:2},extra:{line:{type:"curve",width:2}}}}},onReady:function(){this.syncApiData()},onReachBottom:function(){console.log("触发到底部"),this.total<this.page_value?this.show_hint="无更多数据":(this.show_hint="上滑加载更多数据",this.from=this.from+this.page_value,this.total<=this.page_value&&(console.log("进入添加计算"),this.syncGetHistoryPage(this.page_value,this.from,this.date_value,new Date(this.date_section[0]).getTime(),new Date(this.date_section[1]).getTime())))},methods:{datetime_change:function(e){this.date_section=e,this.from=0,this.syncGetHistoryPage(this.page_value,this.from,this.date_value,new Date(this.date_section[0]).getTime(),new Date(this.date_section[1]).getTime())},date_filters_change:function(e){this.date_value=e,this.from=0,this.syncGetHistoryPage(this.page_value,this.from,this.date_value,new Date(this.date_section[0]).getTime(),new Date(this.date_section[1]).getTime())},page_filters_change:function(e){this.page_value=e,this.from=0,this.syncGetHistoryPage(this.page_value,this.from,this.date_value,new Date(this.date_section[0]).getTime(),new Date(this.date_section[1]).getTime())},getServerData:function(){var e=this;setTimeout((function(){var t={categories:e.charts_XCoords,series:e.charts_data_group};e.chartData=JSON.parse(JSON.stringify(t))}),500)},syncApiData:function(){var e=this;return(0,s.default)(i.default.mark((function t(){return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.syncGetHistoryPage(10,0,1,new Date(e.date_section[0]).getTime(),new Date(e.date_section[1]).getTime());case 2:case"end":return t.stop()}}),t)})))()},syncGetHistoryPage:function(t,n,a,i,s,o){var u=this;return new Promise((function(o,r){e.request({url:"https://voc.16861.com/appapi",data:{m:"app",a:"data",mn:u.equipment_model,from:n,size:t,type:a,accesstoken:u.access_token,gte:i,lt:s},method:"GET",header:{"Content-Type":"application/json"},success:function(e){if(e.data.total<=0)return console.log("查询剩余的数量为0进入"),void(u.show_hint="无更多数据");if(u.show_hint="上滑加载更多数据",200!=e.statusCode)return console.log("--------"),console.log("网络请求失败"),void r("error");if(null==e.data.cp)return console.log("空数据！"),u.equipment_data_group=[],void r("error");var c=e.data.cp,l=[];u.total=e.data.total;var d=[],h=[],m="",f=[],_=[],p={},g=[];for(var v in console.log("total："+u.total+"---from："+n+"---size："+t+"---type:"+a+"---gte起始时间:"+u.getDateTime(i)+"---lt结束时间:"+u.getDateTime(s)),c[0])if("MN"!=v)if("DataTime"==v);else switch("LA"!=v&&"a19002"!=v&&"a34004"!=v&&"a34002"!=v&&"a34001"!=v&&l.push(c[0][v].Name),v){case"a24088":p.name=c[0][v].Name;break;case"ec0000":p.name=c[0][v].Name;break}for(var b in u.equipment_factorName_group=l,c){for(var w in c[b])if("MN"!=w)if("DataTime"==w){switch(a){case 3:m=c[b][w].slice(0,4)+"-"+c[b][w].slice(4,6)+"-"+c[b][w].slice(6,8)+"   "+c[b][w].slice(8,10)+":00",_.push(c[b][w].slice(8,10)+":00");break;case 4:m=c[b][w].slice(0,4)+"-"+c[b][w].slice(4,6)+"-"+c[b][w].slice(6,8),_.push(c[b][w].slice(4,6)+"-"+c[b][w].slice(6,8));break;default:m=c[b][w].slice(0,4)+"-"+c[b][w].slice(4,6)+"-"+c[b][w].slice(6,8)+"   "+c[b][w].slice(8,10)+":"+c[b][w].slice(10,12),_.push(c[b][w].slice(8,10)+":"+c[b][w].slice(10,12));break}d.push(m)}else if("LA"!=w&&"a19002"!=w&&"a34004"!=w&&"a34002"!=w&&"a34001"!=w)if(null!=c[b][w].Avg)switch(d.push(c[b][w].Avg),w){case"a24088":g.push(c[b][w].Avg);break;case"ec0000":null!=c[b][w].Rtd?g.push(c[b][w].Rtd):g.push(c[b][w].Avg);break}else switch(d.push(c[b][w].Rtd),w){case"a24088":g.push(c[b][w].Rtd);break;case"ec0000":g.push(c[b][w].Rtd);break}h.push(d),d=[]}null==p&&""==p||(p.data=g,f.push(p)),0==n?(u.equipment_data_group=h,u.charts_XCoords=_,u.charts_data_group=f,u.from=0):(u.equipment_data_group=u.equipment_data_group.concat(h),u.charts_XCoords=u.charts_XCoords.concat(_),u.charts_data_group[0].data.push.apply(u.charts_data_group[0].data,f[0].data)),u.getServerData(),console.log("图标数据："+JSON.stringify(u.charts_data_group)),u.total<u.page_value?u.show_hint="无更多数据":(u.show_hint="上滑加载更多数据",o("success"))},fail:function(e){console.log(e),r("error")}})}))},getDateTime:function(e){var t=new Date(e),n=e.toString().length;if(n<13){var a=13-n;a=Math.pow(10,a),t=new Date(e*a)}var i=t.getFullYear()+"-",s=t.getMonth()+1;s=(s<10?"0"+s:s)+"-";var o=t.getDate();o=(o<10?"0"+o:o)+" ";var u=t.getHours();u=(u<10?"0"+u:u)+":";var r=t.getMinutes();r=(r<10?"0"+r:r)+":";var c=t.getSeconds();return c=c<10?"0"+c:c,i+s+o+u+r+c},setDateTime:function(){var e=Date.now();this.date_section.push(this.getDateTime(e-864e5)),this.date_section.push(this.getDateTime(e))}}};t.default=o}).call(this,n("df3c")["default"])}},[["1788","common/runtime","common/vendor"]]]);