(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/login/login"],{2015:function(t,e,n){"use strict";var o=n("5c6a"),a=n.n(o);a.a},"5c6a":function(t,e,n){},6063:function(t,e,n){"use strict";n.r(e);var o=n("75b1"),a=n("76f4");for(var c in a)["default"].indexOf(c)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(c);n("bb72"),n("2015");var s=n("828b"),r=Object(s["a"])(a["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],void 0);e["default"]=r.exports},"74ed":function(t,e,n){"use strict";(function(t,e){var o=n("47a9");n("8ed8"),n("c891"),n("861b");o(n("3240"));var a=o(n("6063"));t.__webpack_require_UNI_MP_PLUGIN__=n,e(a.default)}).call(this,n("3223")["default"],n("df3c")["createPage"])},"75b1":function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){}));var o=function(){var t=this.$createElement;this._self._c},a=[]},"76f4":function(t,e,n){"use strict";n.r(e);var o=n("fd18"),a=n.n(o);for(var c in o)["default"].indexOf(c)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(c);e["default"]=a.a},bb72:function(t,e,n){"use strict";var o=n("ff62"),a=n.n(o);a.a},fd18:function(t,e,n){"use strict";(function(t,o){var a=n("47a9");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var c=a(n("7ca3")),s=n("8f59");function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){(0,c.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var u={components:{mInput:function(){n.e("components/m-input").then(function(){return resolve(n("9348"))}.bind(null,n)).catch(n.oe)}},computed:i({},(0,s.mapState)(["hasLogin","forcedLogin"])),data:function(){return{userId:"",password:"",form:{nickName:"",content:"",uuid:"",avatarUrl:"",unionid:""},list:[{user_name:"加载中",content:"加载中"}],wHeight:0}},onLoad:function(){},methods:i(i({},(0,s.mapMutations)(["login"])),{},{signIn:function(){var e=this,n=this.userId,o=this.password;n.length<3||o.length<3?t.showModal({content:"用户名密码长度均不能小于3",showCancel:!1}):(t.showLoading({title:"登录中..."}),t.request({url:"https://voc.16861.com/appapi.php?m=app&username="+this.userId+"&password="+this.password,method:"GET",data:{},success:function(a){t.hideLoading(),console.log(JSON.stringify(a)),-17!=a.data.status?-18!=a.data.status?200==a.data.status&&(e.needCaptcha=!1,console.log(JSON.stringify(a.data.devs)),t.setStorageSync("uni_id_token",a.data.accesstoken),console.log("accesstoken"+a.data.accesstoken),t.setStorageSync("username",a.data.username),t.setStorageSync("login_type","online"),t.setStorageSync("uni_id_has_pwd",!0),200==a.data.status?(e.needCaptcha=!1,console.log(a.data.devs),t.setStorageSync("uni_id_token",a.data.accesstoken),t.setStorageSync("accesstoken",a.data.accesstoken),t.setStorageSync("equipment_type",a.data.roleid),t.setStorageSync("username",a.data.username),t.setStorageSync("realname",a.data.realname),t.setStorageSync("login_type","online"),t.setStorageSync("uni_id_has_pwd",!0),t.setStorageSync("user_id",n),t.setStorageSync("password",o),t.setStorageSync("devs",a.data.devs),t.reLaunch({url:"../my/my"})):(t.showModal({content:a.data.errMsg,showCancel:!1}),e.needCaptcha=!1,t.setStorageSync("uni-needCaptcha",e.needCaptcha),e.needCaptcha&&e.captcha("createCaptcha"))):t.showModal({content:"登陆密码错误",showCancel:!1}):t.showModal({content:"用户不存在,或者已经被删除",showCancel:!1})}}))},toMain:function(e){this.login(e),this.hasLogin?t.reLaunch({url:"../my/my"}):t.navigateBack()},loginMp:function(){t.showLoading({title:"登录中..."}),this.getCode().then((function(t){return console.log("code",t),o.callFunction({name:"login",data:{code:t}})})).then((function(e){if(t.hideLoading(),console.log(e),0!==e.result.status)return Promise.reject(new Error(e.result.msg));t.setStorageSync("token",e.result.token),t.showModal({content:"登录成功，token已存储",showCancel:!1})})).catch((function(e){console.log(e),t.hideLoading(),t.showModal({content:"出现错误，请稍后再试."+e.message,showCancel:!1})}))},getCode:function(){return new Promise((function(e,n){t.login({provider:"weixin",success:function(t){t.code?e(t.code):n(new Error("微信登录失败"))},fail:function(t){n(new Error("微信登录失败"))}})}))},remove:function(t){var e=this;myCloud.callFunction({name:"remove",data:{_id:t}}).then((function(t){e.getData()}))},getData:function(){var t=this;myCloud.callFunction({name:"get"}).then((function(e){t.list=e.result.data}))},appPlusAdd:function(){},add:function(){var e=this;return""==this.form.user_name?(t.showToast({title:"昵称不能为空"}),!1):""==this.form.content?(t.showToast({title:"内容不能为空"}),!1):""==this.form.unionid?(t.showToast({title:"异常请稍后在试"}),!1):void myCloud.callFunction({name:"add",data:this.form}).then((function(t){e.form.content="",e.getData()}))}})};e.default=u}).call(this,n("df3c")["default"],n("861b")["default"])},ff62:function(t,e,n){}},[["74ed","common/runtime","common/vendor"]]]);